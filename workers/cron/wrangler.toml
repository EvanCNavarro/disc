name = "disc-cron"
main = "src/index.ts"
compatibility_date = "2026-02-14"
compatibility_flags = ["nodejs_compat"]

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "disc-db"
database_id = "f3e9b7fb-50c1-45c9-be51-eeef3bcc07a2"

# R2 Bucket (image archive)
[[r2_buckets]]
binding = "IMAGES"
bucket_name = "disc-images"

# Cron trigger: every 5 min â€” handles both watcher (auto-detect) and
# scheduled cron (smart regeneration, matched by user's HH:MM cron_time)
[triggers]
crons = ["*/5 * * * *"]

# Secrets (set via: wrangler secret put <KEY> --config workers/cron/wrangler.toml)
# - REPLICATE_API_TOKEN
# - OPENAI_API_KEY
# - ENCRYPTION_KEY
# - SPOTIFY_CLIENT_ID
# - SPOTIFY_CLIENT_SECRET

[vars]
ENVIRONMENT = "production"
